<!doctype html>

<head>
  <style>
    body {
      background-color: rgb(23, 238, 173);
      padding: 10px 10px;
    }

    canvas {
      display: block;
      margin: auto;
    }

  </style>

  <title>Doodle who jumps</title>
  <script src="jumper.js"></script>
  <script src="enemy.js"></script>
</head>

<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
</body>
<script>
  var canvas, canvasContext;

  window.onload = function () {
    canvas = document.getElementById('gameCanvas');
    canvasContext = canvas.getContext('2d');

    document.addEventListener('keydown', keyPressed);
    document.addEventListener('keyup', keyReleased);

    setInterval(mainloop, 1000 / 50);
  }
  // player vars
  var pXpos = 375;
  var pYpos = 575;
  var pXspeed = 5;
  var pYspeed = 5;
  const P_SIZE = 25;
  var yVel = 0; //gravity
  var thrust = -5; // gravity speed



  // key codes
  const UP_KEY = 87;
  const LEFT_KEY = 65;
  const RIGHT_KEY = 68;
  const SPACE_KEY = 32;
  var upPressed = false;
  var downPressed = false;
  var leftPressed = false;
  var rightPressed = false;
  var spacePressed = false;

  var player = new Player(pXpos, pYpos, P_SIZE, P_SIZE, 'red', pXspeed, pYspeed, yVel, thrust);

  var setUp = true;

  function mainloop() {
    if (setUp) {
      for (var i = 0; i < 10; i++) {
        createEnemy();
      }
      setUp = false;
    }
    colorRect(0, 0, canvas.width, canvas.height, 'black'); // bg
    player.drawRect(); // player
    player.playerMove();
    
      if (enemies.length > 0) {
          enemies.forEach(function (enemy, i, array) {
            enemy.drawRect();
            enemy.enemyMove();
            if(enemy.playerDeath()){
              console.log('dead');
            }
          }); // end foreach
        } // end if 
  }

  var enemies = [];

   function createEnemy(){
    // enemy vars
    var eSize = Math.floor(Math.random() * (40 - 20) + 20);
    var eYpos = eSize;
    var eXpos = Math.floor(Math.random() * (canvas.width - eSize));
    var eXspeed = Math.floor(Math.random() * (12 - 3) + 3);
    var eYspeed = Math.floor(Math.random() * (12 - 3) + 3);

    // create enemy class with vars
    var enemy = new Enemy(eXpos, eYpos, eSize, eSize, 'purple', eXspeed, eYspeed);
    // add enemy to enemies array
    enemies.push(enemy); 
  } // end func



  function keyPressed(evt) {
    if (evt.keyCode == LEFT_KEY) {
      leftPressed = true;
    }
    if (evt.keyCode == RIGHT_KEY) {
      rightPressed = true;
    }
    if (evt.keyCode == SPACE_KEY) {
      spacePressed = true;
    }
  }

  function keyReleased(evt) {
    if (evt.keyCode == LEFT_KEY) {
      leftPressed = false;
    }
    if (evt.keyCode == RIGHT_KEY) {
      rightPressed = false;
    }
    if (evt.keyCode == SPACE_KEY) {
      spacePressed = false;
    }
  } // end of func



  function colorRect(x, y, w, h, c) {
    canvasContext.fillStyle = c;
    canvasContext.fillRect(x, y, w, h);
  }
</script>
